var totals = [
    {
        "all": 1806,
        "days": 567,
        "action": "Symbolic Act",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 365,
        "action": "Other Personal Attack",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 356,
        "action": "Verbal or Written Expression",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 232,
        "action": "unknown",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 230,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 181,
        "action": "Verbal or Written Expression",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 51,
        "action": "Verbal or Written Expression",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 51,
        "action": "Verbal or Written Expression",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 46,
        "action": "Forming an Association",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 32,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 31,
        "action": "Other Personal Attack",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 31,
        "action": "unknown",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 19,
        "action": "unknown",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 12,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 12,
        "action": "Symbolic Act",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 12,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 11,
        "action": "Verbal or Written Expression",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 8,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 8,
        "action": "Other Personal Attack",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 7,
        "action": "Riot or Brawl",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 7,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 7,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 7,
        "action": "Symbolic Act",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 6,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 6,
        "action": "Symbolic Act",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 6,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 5,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 5,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 4,
        "action": "unknown",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Symbolic Act",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Symbolic Act",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Symbolic Act",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Verbal or Written Expression",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Verbal or Written Expression",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Verbal or Written Expression",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "unknown",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Riot or Brawl",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Riot or Brawl",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Verbal or Written Expression",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "unknown",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Riot or Brawl",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Riot or Brawl",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Verbal or Written Expression",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "unknown",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Riot or Brawl",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Other Personal Attack",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Kidnap/Hostage",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Verbal or Written Expression",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Other Personal Attack",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Other Personal Attack",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Other Property Attack",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Symbolic Act",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Verbal or Written Expression",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Other Personal Attack",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "unknown",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Other Personal Attack",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "unknown",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Mass Demonstration or Strike",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "unknown",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Other Personal Attack",
        "": "",
        "__1": ""
  },
    {
        "all": 1806,
        "days": 1,
        "action": "Other Personal Attack",
        "": "",
        "__1": 155316
  }
]


function australia() {

    totals_ = new Map()

    totals.forEach((d) => {
        if (totals_[d["action"]]) {
            totals_[d["action"]] += d.days;
        } else {
            totals_[d["action"]] = d.days;

        }
    })

    list = []
    for (var key in totals_) {
        list.push({
            action: key,
            days: totals_[key]
        });
    }

    list.sort((d1, d2) => d1.days - d2.days)
    totals = list;

    console.log(totals)

    var width = 180;
    var height = 180;
    var radius = Math.min(width, height) / 2;
    var donutWidth = 18;
    var color = d3.scaleOrdinal(["#9E0C3C", "#B01135", "#CD1B2D", "#E82322", "#FB291B", "#ff5555", "#ff8080", "#ffaaaa"]);


    var svg = d3.select('#donut1')
        .append('svg')
        .attr('width', width)
        .attr('height', height)
        .append('g')
        .attr('transform', 'translate(' + (width / 2) +
            ',' + (height / 2) + ')');

    var arc = d3.arc()
        .innerRadius(radius - donutWidth)
        .outerRadius(radius);

    var pie = d3.pie()
        .value(function (d) {
            return d.days;
        })
        .sort(null);

    var path = svg.selectAll('path')
        .data(pie(totals))
        .enter()
        .append('path')
        .attr('d', arc)
        .attr('fill', function (d, i) {
            return color(d.data.action);
        })
        .attr('transform', 'translate(0, 0)')
        .on('mouseover', function (event, d) {

            /*  d3.select(this).transition()
      .attr('opacity', 0.5);
  donutTip.transition()
      .style("opacity", 1);*/
            svg.append("text")
                .attr("class", "donuttooltip")
                .text(d.data.days + " days")
                .attr("x", 0)
                .attr("y", 18)
                .style("font-size", 12)
                .style("fill", "white")
                .style("text-anchor", "middle")
                .style("alignment-baseline", "middle")

            svg.append("text")
                .attr("class", "donuttooltip")
                .text(d.data.action)
                .attr("x", 0)
                .attr("y", 32)
                .style("font-size", 12)
                .style("fill", "white")
                .style("text-anchor", "middle")
                .style("alignment-baseline", "middle")


            /*           
                         donutTip
                             .html(d.data.days + " days")
                             .style("left", (this.getBBox().x + this.getBBox().width / 3 + width /2) + "px")
                             .style("top", (this.getBBox().y + this.getBBox().height / 3 + height/2) + "px");*/

        })
        .on('mouseout', function (event, d) {

            svg.selectAll(".donuttooltip").remove();
            /*d3.select(this).transition()
                .attr('opacity', 1);
                        donutTip.transition()
                            .style("opacity", 0);*/
        });

    var textAus = svg.append('text')
        .attr("class", "Aus")
        .text('Australia')
        .attr("fill", "white") // set color
        .attr("class", "cname")
        .attr("x", 0)
        .attr("y", 0)
        .style("font-size", 16)
        .style("text-anchor", "middle")
        .style("alignment-baseline", "middle")

    console.log(text);

};

australia();
